{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '46726016-b290741f0a1b76ad16aa31499';\naxios.defaults.baseURL = 'https://pixabay.com/api/';\n\nasync function getImg(searchValue, page = 1) {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: searchValue,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    per_page: 15,\n    page,\n  });\n\n  const response = await axios.get(`?${searchParams}`);\n  return response.data;\n}\n\nexport { getImg };\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet galleryLightbox;\n\nfunction createCardsMarkup(cards, append = false) {\n  const cartItem = cards\n    .map(\n      ({\n        tags,\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n      <li class=\"gallery-card\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img class=\"gallery-img\" src=\"${webformatURL}\" alt=\"${tags}\" />\n            <div class=\"values-container\">\n                <ul class=\"labels\">\n                    <li>Likes</li>\n                    <li>${likes}</li>\n                </ul>\n                <ul class=\"labels\">\n                    <li>Views</li>\n                    <li>${views}</li>\n                </ul>\n                <ul class=\"labels\">\n                    <li>Comments</li>\n                    <li>${comments}</li>\n                </ul>\n                <ul class=\"labels\">\n                    <li>Downloads</li>\n                    <li>${downloads}</li>\n                </ul>\n            </div>\n        </a>\n      </li>`\n    )\n    .join('');\n\n  loadSimpleLitebox(cartItem, append);\n}\n\nfunction loadSimpleLitebox(cartItem, append) {\n  const gallery = document.querySelector('ul.images-div');\n  if (append) {\n    gallery.insertAdjacentHTML('beforeend', cartItem);\n  } else {\n    gallery.innerHTML = cartItem;\n  }\n\n  if (galleryLightbox) {\n    galleryLightbox.refresh();\n  } else {\n    galleryLightbox = new SimpleLightbox('.images-div a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n  }\n}\n\nexport { createCardsMarkup };\n","import { getImg } from './js/pixabay-api';\nimport { createCardsMarkup } from './js/render-functions';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst fetchUsersBtn = document.querySelector('button[type=submit]');\nconst imgs = document.querySelector('.images-div');\nconst loaderClass = document.querySelector('.loaderClass');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nlet currentPage = 1;\nlet currentSearchQuery = '';\n\nfetchUsersBtn.addEventListener('click', handleSearch);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nasync function handleSearch(evt) {\n  evt.preventDefault();\n  const searchInput = document.querySelector('input[name=\"search\"]');\n  const notFoundTextEl = document.querySelector('.not-found-img');\n  const searchValue = searchInput.value.trim();\n\n  if (searchValue.length === 0) {\n    iziToast.show({\n      title: '❌',\n      message: 'Please enter a search query!',\n      color: 'ef4040',\n    });\n    return;\n  }\n\n  currentPage = 1;\n  currentSearchQuery = searchValue;\n  imgs.innerHTML = '';\n  loadMoreBtn.style.display = 'none';\n  notFoundTextEl.innerHTML = '';\n  loaderClass.style.display = 'flex';\n\n  try {\n    const data = await getImg(searchValue, currentPage);\n\n    if (data.total === 0) {\n      notFoundTextEl.innerHTML = `Results for query <span>${searchValue}</span> not found!`;\n      iziToast.show({\n        title: '❌',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        backgroundColor: '#ef4040',\n        messageColor: 'white',\n      });\n      return;\n    }\n\n    createCardsMarkup(data.hits);\n\n    if (data.totalHits > currentPage * 15) {\n      loadMoreBtn.style.display = 'block';\n    } else {\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: '#4e75ff',\n        messageColor: 'white',\n      });\n    }\n\n    await handleImagesLoad();\n  } catch (error) {\n    console.error(error);\n    iziToast.show({\n      title: '❌',\n      message: 'An error occurred while fetching images',\n      backgroundColor: '#ef4040',\n      messageColor: 'white',\n    });\n  } finally {\n    loaderClass.style.display = 'none';\n    searchInput.value = '';\n  }\n}\n\nasync function handleLoadMore() {\n  currentPage += 1;\n  loadMoreBtn.style.display = 'none';\n  loaderClass.style.display = 'flex';\n\n  try {\n    const data = await getImg(currentSearchQuery, currentPage);\n    createCardsMarkup(data.hits, true);\n\n    // Отримання висоти карточки після рендеру\n    const cardHeight = document\n      .querySelector('.gallery-card')\n      .getBoundingClientRect().height;\n\n    // Плавне прокручування на 2 висоти карточки\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    loaderClass.style.display = 'none';\n\n    if (currentPage * 15 >= data.totalHits) {\n      loadMoreBtn.style.display = 'none';\n      iziToast.show({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        backgroundColor: '#4e75ff',\n        messageColor: 'white',\n      });\n    } else {\n      loadMoreBtn.style.display = 'block';\n    }\n\n    await handleImagesLoad();\n  } catch (error) {\n    console.error(error);\n    iziToast.show({\n      title: '❌',\n      message: 'An error occurred while loading more images',\n      backgroundColor: '#ef4040',\n      messageColor: 'white',\n    });\n    loaderClass.style.display = 'none';\n  }\n}\n\nasync function handleImagesLoad() {\n  const imageElements = document.querySelectorAll('.gallery-img');\n  const loadPromises = Array.from(imageElements).map(img => {\n    return new Promise(resolve => {\n      img.onload = resolve;\n      img.onerror = resolve;\n    });\n  });\n\n  await Promise.all(loadPromises);\n}\n"],"names":["API_KEY","axios","getImg","searchValue","page","searchParams","galleryLightbox","createCardsMarkup","cards","append","cartItem","tags","webformatURL","largeImageURL","likes","views","comments","downloads","loadSimpleLitebox","gallery","SimpleLightbox","fetchUsersBtn","imgs","loaderClass","loadMoreBtn","currentPage","currentSearchQuery","handleSearch","handleLoadMore","evt","searchInput","notFoundTextEl","iziToast","data","handleImagesLoad","error","cardHeight","imageElements","loadPromises","img","resolve"],"mappings":"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"}